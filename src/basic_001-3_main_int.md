# main関数がint型の理由
> int main{...}はメインプログラムのことだと思いますが，なぜ整数型(int)なのでしょうか

***
## ![](./img/KANAMI.png "KANAMI") <font color="Maroon">KANAMI</font>

うわ、すごい！ めっちゃ良いところに気づいたね！

Fortranだと`PROGRAM`で始まって`END PROGRAM`で終わるし、Pythonはファイルの先頭から実行されるから、`main`が型を持ってるのって不思議に思うよね。その通り、`main`はプログラムの本体なんだけど、`int`がついてるのにはちゃんと深い理由があるんだよ。

結論から言うと、`main`関数の戻り値である整数（`int`）は、**プログラムが終了したときの「状態」を、それを呼び出したOS（オペレーティングシステム）に伝えるための「報告書」** なんだ。

### `main`はOSとの約束

君が書いたプログラムは、単体で動いているように見えて、実はOS（Windows, macOS, Linuxなど）に「実行してください」とお願いされて動作している。

`main`関数は、プログラムにとっての「ミッション」そのものなんだ。そして、関数が終わるときに `return` で返す整数値は、そのミッションがどう終わったかを報告する **「任務完了報告書」** みたいなものなんだよ。

誰に報告するかって？ それは、このプログラムを呼び出した**OS**や、君がコマンドを打ち込んだ**ターミナル**だね。

### 報告書（戻り値）の意味

この報告書には、世界共通のルールがあるんだ。

* `return 0;`
    * **意味：「ミッションは完璧に成功しました！問題なし！」**
    * `0`は**正常終了**を意味する、というのが大昔からの慣習なんだ。プログラムが想定通りに全ての処理を終えたことを示す。
    * `cstdlib`ヘッダにある`EXIT_SUCCESS`っていう定数（中身は`0`）を使うと、もっと意味が分かりやすくなるよ。

* `return 1;` （または`0`以外の整数）
    * **意味：「ミッション失敗！何か問題が発生しました！」**
    * `0`以外の値は**異常終了**を示す。例えば、「開こうとしたファイルが見つからなかった」「計算に必要なメモリが足りなかった」「ユーザーの入力値が不正だった」みたいなケースだね。
    * どんなエラーが起きたかによって、返す値を変えることもあるよ（例えば「ファイル無し」は`1`、「権限無し」は`2`、とかね）。
    * `EXIT_FAILURE`っていう定数（中身はだいたい`1`）も用意されてる。

### これが何の役に立つの？

「別にOSに報告しなくても、画面に『成功しました』って表示すればいいじゃん」って思うかもしれないけど、この仕組みは**プログラムを自動化する**ときに絶大なパワーを発揮するんだ。

例えば、LinuxやmacOSのターミナルで、こんなコマンドを打てることがある。

```bash
./my_program && echo "プログラムが成功したので次の処理を実行します"
```

この `&&` は、「左側のコマンドが**成功（戻り値0）** したら、右側のコマンドを実行する」っていう意味なんだ。

もし君の`my_program`が、処理に失敗したときに`return 1;`を返すように作ってあれば、`&&`の右側の`echo`コマンドは実行されない。この仕組みのおかげで、「Aの処理が成功したらBをやって、Bが成功したらCをやる」みたいな一連の処理を安全に自動化できるんだよ。

**例：エラーがあったら `1` を返すプログラム**
```cpp
#include <iostream>
#include <fstream> // ファイルを扱うために必要

int main() {
    // 存在しないファイルを読み込もうとしてみる
    std::ifstream file("this_file_does_not_exist.txt");

    // fileが開けているかチェック
    if (!file) {
        // C++ではエラーメッセージは std::cerr に出すのがお作法
        std::cerr << "エラー: ファイルを開けませんでした。" << std::endl;
        
        // OSに「異常終了したよ！」と報告
        return 1; 
    }

    std::cout << "ファイルは正常に開けました。" << std::endl;
    // ... 本来の処理 ...

    // ここまで来たら正常終了
    return 0;
}
```

というわけで、`main`が`int`型なのは、プログラムが社会（OS）の一員として、自分の仕事の結果をちゃんと報告するための、とっても大事な作法なんだ。

こういう裏側の仕組みを知ると、もっとプログラミングが面白くなるでしょ！
