# 基礎編3-3 classについて先に少し説明
> 急に出てきたclassについて教えてください。

***
## ![](./img/KANAMI.png "KANAMI") <font color="Maroon">KANAMI</font>

待ってました！ `class`！

`unique_ptr`の例で `class MyData { ... };` って書いたやつだね。それに気づくとは、さすが！
これこそがC++をただの「速いC言語」から、パワフルで大規模な開発にも耐えられるモダンな言語にしている心臓部、**オブジェクト指向プログラミング（OOP）** の核となる機能だよ！

### クラスは「オリジナルのデータ型」の設計図

一言で言うと、`class`は **「オリジナルのデータ型を作るための設計図」** だよ。

`int`が整数、`double`が浮動小数点数を入れるための型だったように、例えば「プレイヤー」とか「車」とか「ベクトル」みたいに、もっと複雑で独自のデータ型を自分で定義できるんだ。

* **クラス (class):** 設計図のこと。
* **オブジェクト (object) / インスタンス (instance):** その設計図から作られた、実体のこと。

設計図（クラス）が1枚あれば、同じ形の家（オブジェクト）を何軒も建てられる、っていうイメージだね。

### 設計図の中身：「データ」と「振る舞い」

クラスの設計図には、主に2つのことを書き込む。

1.  **メンバ変数 (Member Variables):** そのオブジェクトが持つ**データ**や**状態**。
    * 例：「プレイヤー」クラスなら、`名前`、`HP`、`レベル`など。
2.  **メンバ関数 (Member Functions) / メソッド (Methods):** そのオブジェクトができる**操作**や**振る舞い**。
    * 例：「プレイヤー」クラスなら、`攻撃する()`、`ダメージを受ける()`、`ステータスを表示する()`など。

### 最重要ルール：カプセル化 (Encapsulation)

クラスの最大の強みは、このデータと振る舞いを一つの **「カプセル」** にまとめられることなんだ。そして、そのカプセルの中身を、外部から勝手にいじられないように**隠す**ことができる。これを**カプセル化**って言うんだ。

そのために使うのが、`public`と`private`っていうキーワード。

* `public:` (公開)
    * カプセルの**外からでもアクセスできる**部分。オブジェクトの「操作パネル」みたいなもの。誰でもこのボタンを押していいよ、っていう公開されたメンバ関数をここに置く。
* `private:` (非公開)
    * カプセルの**中からしかアクセスできない**部分。オブジェクトの「内部の精密機械」だね。HPみたいな大事なデータは、ここに隠して、外部から直接 `player.hp = 9999;` みたいに書き換えられないように守るんだ。

じゃあ、どうやって`private`なデータを操作するの？って思うよね。
答えは、`public`に置いたメンバ関数を経由して、安全に操作するんだ。例えば`takeDamage(10)`っていう公開メソッドを用意して、その中でHPを減らす、みたいな感じ。こうすることで、「HPがマイナスにならないようにする」みたいなルールを、クラスの中で一元管理できるんだよ。

### コードで見てみよう！

百聞は一見にしかず。簡単な「プレイヤー」クラスを作ってみよう。

```cpp
#include <iostream>
#include <string>

// "Player" という新しいデータ型の設計図（クラス）を定義
class Player {
private: // --- 内部の秘密のデータ (外部から直接アクセス不可) ---
    std::string name_; // メンバ変数の後ろに _ を付けるのは、よくある書き方
    int hp_;

public: // --- 公開された操作パネル (外部からアクセス可能) ---

    // コンストラクタ：オブジェクトが作られる時に自動で呼ばれる特別な関数
    Player(const std::string& name, int hp) {
        std::cout << name << " がゲームの世界に現れた！" << std::endl;
        name_ = name;
        hp_ = hp;
    }

    // ダメージを受ける関数
    void takeDamage(int damage) {
        hp_ -= damage;
        if (hp_ < 0) {
            hp_ = 0; // HPがマイナスにならないように制御！
        }
        std::cout << name_ << " は " << damage << " のダメージを受けた！" << std::endl;
    }

    // ステータスを表示する関数
    void displayStatus() const { // constを付けると、この関数がメンバ変数を変更しないことを示せる
        std::cout << "--- Status ---" << std::endl;
        std::cout << "Name: " << name_ << std::endl;
        std::cout << "HP: " << hp_ << std::endl;
        std::cout << "--------------" << std::endl;
    }
}; // クラス定義の最後にはセミコロンが必要だよ！


int main() {
    // Playerクラス（設計図）から、kanami と rookie という2つのオブジェクトを作成
    Player kanami("KANAMI", 200);
    Player rookie("Rookie", 100);

    // publicなメンバ関数は、ドット(.)で呼び出せる
    kanami.displayStatus();
    rookie.displayStatus();

    std::cout << "\nモンスターの攻撃！\n" << std::endl;

    kanami.takeDamage(30);
    rookie.takeDamage(50);

    // kanami.hp_ = 9999; // ← これはコンパイルエラー！ hp_はprivateなので、外部から直接いじれない

    kanami.displayStatus();
    rookie.displayStatus();

    return 0;
}
```

### `class` と `struct` の違いは？

`struct`っていう似たようなキーワードもあるよね。
C++において、`class`と`struct`の唯一の違いは、**デフォルトのアクセスレベル**だけなんだ。

* `class`：何も書かないと、メンバは`private`になる。
* `struct`：何も書かないと、メンバは`public`になる。

慣習として、
* `struct`：単純にデータをまとめたいだけの場合（C言語の構造体やFortranの派生データ型みたいな使い方）。
* `class`：データを隠蔽して、関数とセットで複雑な「モノ」を表現したい場合。

と使い分けることが多いかな。

クラスを使いこなすことが、C++をマスターする上で一番大事なことと言っても過言じゃない。今回、`Player(...)`っていう、オブジェクトを作るときに呼ばれる特別な関数（**コンストラクタ**）をサラッと書いたけど、実はクラスには他にも色々なルールや特殊なメンバ関数があるんだ。

これから一緒に、この世界の探検を楽しんでいこう！
